---
title: "Comparison of the exponential distribution and the Central Limit Theorem"
output: pdf_document
date: "2023-08-07"
---

# Comparison of the exponential distribution and the Central Limit Theorem

**Purpose:** The objective of the simulation exercise is to explore the exponential distribution and its relationship with the Central Limit Theorem.

**Introduction:** The Exponential distribution or negative exponential is the probability distribution of the time between events in a Poisson point process; In which events occur continuously and independently at a constant average rate. One property of the exponential distribution is that it can be viewed as a continuous analogue of the geometric distribution.

The central limit theorem is one of the most useful concepts in statistics. The theorem is all about drawing samples of a finite size n from a population. The theorem states that if one collects samples of a large enough sample size n , and calculates each sample's mean (or sum), the shape of the histogram of those means (or sums) approximates a normal bell shape. The usefulness of the central limit theorem is due to the fact, that it does not matter what the distribution of the original population is, the distribution of sample means and the sums tend to follow the normal distribution.

Hence, when conducting 1000 simulations with a sample size of 40 drawn from the exponential distribution, the resulting distribution of sample means is inclined to exhibit a resemblance to the normal distribution, as outlined below.

**Part 1A - Simulation -graph:** first, lets look at how one exponential simulation n=40 and a rate lambda= 0.2 looks like:

```{r qplot, fig.width=4,fig.height=3,message=FALSE }
library(ggplot2)
SimPlot<- ggplot()+
  geom_histogram(
    mapping = aes(x=(rexp(40*1000,rate = lambda))),
    color="gray50",bins = 50
  )+
  geom_vline(xintercept=meanEXP,colour="red")+
  geom_vline(xintercept=mean((rexp(1000*40,rate = lambda)),colour="black"))+
  annotate("pointrange",x=mean((rexp(1000*40,rate = lambda))),
           y=3000, ymin = 2000,ymax = 5000,
           size = 1.5, linewidth = 1.5,
           colour="black")+
  annotate("pointrange",x=meanEXP,y=3000, 
           ymin = 2000,ymax = 5000,
           size = .5, linewidth = .5,
           colour="red")+
  labs(title = "Exponent Distribution",tag = "Part A1",x="X",y="Y")

SimPlot

```



**part 1B - Theoretical vs Simulation; Comparison of the Means**
then, lets look to the mean of a thousand exponential distributions with a n=40 and a rate parameter lambda= 0.2.
```{r qplot, message=FALSE }
plotgg2<-ggplot(as.data.frame(MeansPerSimulation),aes(as.numeric(MeansPerSimulation))) + 
  geom_bar(fill = "white",colour = "white") + 
  scale_x_binned()+
  geom_vline(xintercept=meanEXP,colour="red")+
  geom_vline(xintercept=Smean,colour="black")+
  annotate("text",x=Smean,y=300, label=paste("Population-Mean: ",Smean),colour="black")+
  annotate("text",x=meanEXP,y=250, label=paste("Theoretical- Mean: ",meanEXP),colour="red")+
  labs(title = "Exponential Distribution- Theoretical vs Sample",tag = "Part A1",x="X",y="Y")
plotgg2
```

The CLT states that the distribution of averages of iid variables becomes that of a standard

**part 1C - Variance** According with the Central Limit Theorem, the distribution of the sample variance of a random sample from a population is centered at the population variance. This means that on average, the sample variances will be equal to the population variance. The sample variance is a measure of the spread of data within a sample, and it is calculated by taking the average of the squared differences between each data point and the sample mean. When multiple random samples are taken, the sample variances will vary around the population variance. However, the distribution of these sample variances is centered at the population variance, indicating that the average sample variance will be equal to the population variance.

```{r qplot,message=FALSE }

varPlot<-ggplot(as.data.frame(VarPerSimultation),aes(as.numeric(VarPerSimultation))) +
  geom_histogram(alpha=.5, position="identity", fill="white", col="black")+
  geom_vline(xintercept=varEXP,colour="red")+
  geom_vline(xintercept=Svar,colour="black")+
  scale_color_manual(name = "", values = c( "red", "black")) +

  labs(title = "Simulation Variances Distributions " ,
       tag = "Part 1B",
       x="X",y="Y",
       caption = paste("Theoretical- Variability: ",varEXP,"\n","Simulation-Variability: ",Svar), 
       alt = paste("A scatterplot showing"),
       alt_insight = paste("Theoretical- Variability: ",varEXP),)
varPlot

```

**Part 1D - Distributions**

```{r qplot,message=FALSE }
plotgg3<-ggplot(as.data.frame(MeansPerSimulation),aes(as.numeric(MeansPerSimulation))) + 
  geom_histogram(aes(y=after_stat(density)), alpha=.5, position="identity", fill="white", col="black")+
  geom_density(colour="black", size=1)+
  stat_function(fun = dnorm, colour = "red", size=1,args = list(mean = meanEXP, sd = sd(MeansPerSimulation)))+
  annotate("text",x=6.5,y=.5, label="Exponential Distribution",colour="red")+
  annotate("text",x=6.5,y=.4, label=" Central Limit Theorem",colour="black")+
  labs(title = "Central Limit Theorem vs Exponential Distribution",tag = "Part 1C",x="X",y="Y")
plotgg3
```

**Citations:** - \<<https://rmarkdown.rstudio.com/authoring_quick_tour.html#Markdown_Basics>. - <https://www.probabilitycourse.com/chapter4/4_2_2_exponential.php>. - <https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Central-Limit-Theorem/index.html>.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
